<!DOCTYPE html>
<html lang="pt-PT">
    <head>
        <meta charset="UTF-8">
        <meta name="description" content="A Voz ao Seu Lado">
        <meta name="keywords" content="rádio, música, notícias, entretenimento, literatura, cultura, português">
        <meta name="author" content="André Machado">
        <meta name="robots" content="index, follow">
        <meta name="revisit-after" content="1 day">
        <meta name="googlebot" content="noodp">
        <meta name="rating" content="general">
        <meta name="distribution" content="global">
        <title>Rádio Aberta</title>
        <link rel="stylesheet" type="text/css" href="style.css">
        <!-- Import the Leaflet library for interactive maps -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
        <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
        <!-- Import Chessboard.js CSS -->
        <link rel="stylesheet"
            href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css"
            integrity="sha384-q94+BZtLrkL1/ohfjR8c6L+A6qzNH9R2hBLwyoAfu3i/WCvQjzL2RQJ3uNHDISdU"
            crossorigin="anonymous">
        <!-- Import the Howler.js library for audio playback -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js"></script>
        <!-- Import the jQuery library for DOM manipulation -->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2"
            crossorigin="anonymous"></script>
        <!-- Import the Chessboard.js library for displaying chess boards -->
        <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"
                integrity="sha384-8Vi8VHwn3vjQ9eUHUxex3JSN/NFqUg3QbPyX8kWyb93+8AC/pPWTzj+nHtbC5bxD"
                crossorigin="anonymous"></script>
        <!-- Import the chess.js library for chess game logic -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.2/chess.min.js"></script>
        <!-- Update Radio Program -->
        <script>
            // Ensure DOM is fully loaded
            document.addEventListener('DOMContentLoaded', function() {
                // Show the current program being played
                const currentProgram = document.createElement('p');
                currentProgram.style.fontWeight = 'bold';
                currentProgram.style.marginTop = '20px';
                currentProgram.style.textAlign = 'center'; // Center the message
                document.querySelector('header').appendChild(currentProgram);
        
                // Define program names as constants for easy reference
                const PROGRAMA_DA_MANHA = 'Programa da Manhã';
                const MUSICA_INTERNACIONAL = 'Música Internacional';
                const NOTICIAS_E_ATUALIDADES = 'Notícias e Atualidades';
                const PROGRAMA_DA_TARDE = 'Programa da Tarde';
                const MUSICA_PORTUGUESA = 'Música Portuguesa';
                const PROGRAMA_LITERATURA = 'Programa de Literatura';
                const ESTILO_LIVRE = 'Estilo Livre';
        
                // Function to update the current program being played
                const updateCurrentProgram = () => {
                    const currentDate = new Date();
                    const currentHour = currentDate.getHours();
                    const currentDay = currentDate.getDay();
        
                    // Function to stop any currently playing audio
                    const stopCurrentAudio = () => {
                        if (window.currentAudio) {
                            window.currentAudio.stop();
                        }
                    };

                    // Check the current day and hour to display the current program
                    if (currentDay >= 1 && currentDay <= 5) { // Monday to Friday
                        if (currentHour >= 9 && currentHour < 10) {
                            currentProgram.textContent = PROGRAMA_DA_MANHA;
                            stopCurrentAudio();
                            window.currentAudio = playMusicaPortuguesa();
                        } else if (currentHour >= 10 && currentHour < 13) {
                            currentProgram.textContent = MUSICA_INTERNACIONAL;
                            stopCurrentAudio();
                            window.currentAudio = playMusicaInternacional();
                        } else if (currentHour >= 13 && currentHour < 14) {
                            currentProgram.textContent = NOTICIAS_E_ATUALIDADES;
                            stopCurrentAudio();
                            window.currentAudio = playNoticiasEAtualidades();
                        } else if (currentHour >= 14 && currentHour < 16) {
                            currentProgram.textContent = PROGRAMA_DA_TARDE;
                            stopCurrentAudio();
                            window.currentAudio = playMusicaInternacional();
                        } else {
                            currentProgram.textContent = ESTILO_LIVRE;
                            stopCurrentAudio();
                            window.currentAudio = playEstiloLivre();
                        }
                    } else if (currentDay === 6) { // Saturday
                        if (currentHour >= 10 && currentHour < 12) {
                            currentProgram.textContent = MUSICA_PORTUGUESA;
                            stopCurrentAudio();
                            window.currentAudio = playMusicaPortuguesa();
                        } else {
                            currentProgram.textContent = ESTILO_LIVRE;
                            stopCurrentAudio();
                            window.currentAudio = playEstiloLivre();
                        }
                    } else if (currentDay === 0) { // Sunday
                        if (currentHour >= 10 && currentHour < 12) {
                            currentProgram.textContent = PROGRAMA_LITERATURA;
                            stopCurrentAudio();
                            window.currentAudio = playProgramaLiteratura();
                        } else {
                            currentProgram.textContent = ESTILO_LIVRE;
                            stopCurrentAudio();
                            window.currentAudio = playEstiloLivre();
                        }
                    } else {
                        currentProgram.textContent = ESTILO_LIVRE;
                        stopCurrentAudio();
                        window.currentAudio = playEstiloLivre();
                    }
                };
        
                // Call the function to set initial state
                updateCurrentProgram();
        
                // Update the program every minute to ensure accuracy
                setInterval(updateCurrentProgram, 60000);
            });
        </script>
        <script>
            document.addEventListener('DOMContentLoaded', (event) => {
                // Função para atualizar data e hora
                function updateDateTime() {
                    const currentDate = new Date();
                    const weekDays = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
                    const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
            
                    // Obter a abreviação do dia da semana
                    const weekDay = weekDays[currentDate.getDay()];
                    // Formatar o mês, dia, ano, hora, minuto e segundo
                    const day = currentDate.getDate();
                    const month = months[currentDate.getMonth()];
                    const year = currentDate.getFullYear();
                    const hour = currentDate.getHours();
                    const minute = currentDate.getMinutes().toString().padStart(2, '0');
                    const second = currentDate.getSeconds().toString().padStart(2, '0');
            
                    // Montar a string de data e hora
                    const currentDateTime = `${weekDay}, ${day} ${month} ${year}, ${hour}:${minute}:${second}`;
            
                    // Restante do código para atualizar o parágrafo na página...
                    let dateParagraph = document.querySelector('#currentDateTime');
                    if (!dateParagraph) {
                        dateParagraph = document.createElement('p');
                        dateParagraph.id = 'currentDateTime';
                        const titleElement = document.querySelector('h1');
                        titleElement.insertAdjacentElement('afterend', dateParagraph);
                    }
                    dateParagraph.innerHTML = `<span style='font-size: 14px; font-weight: bold; color: #006600;'>${currentDateTime}</span><span style='font-size: 14px; font-weight: bold; color: #FFD700;'> (Portugal</span> <span style='font-size: 14px; font-weight: bold; color: #FF0000;'>Continental)</span>`;
                }
            
                // Atualizar data e hora imediatamente e a cada minuto
                updateDateTime();
                setInterval(updateDateTime, 1000);
            });
        </script>
    </head>
    <body>
        <header>
            <center>
                <h1>Rádio Aberta</h1>
                <div>
                    <button id="playButton">Tocar</button>
                    <button id="pauseButton">Pausa</button>
                </div>
            </center>
        </header>
        <main>
            <h2>Bem-vindo à Rádio Aberta</h2>
            <section style="width: 75%">
                <p>A Rádio Aberta é mais do que uma estação de rádio online; é um elo vibrante que conecta a comunidade portuguesa global, incluindo os países da CPLP (Comunidade dos Países de Língua Portuguesa). Oferecemos uma vasta gama de conteúdos que incluem música, notícias e programas de entretenimento, todos cuidadosamente preparados para atender aos interesses e necessidades dos nossos ouvintes em qualquer parte do mundo.</p>
                <p>O nosso objetivo é proporcionar uma experiência radiofónica rica e envolvente, inteiramente em língua portuguesa. Queremos que cada transmissão seja uma viagem sonora que os nossos ouvintes possam apreciar, onde quer que estejam. Seja ao som das últimas novidades musicais ou durante a cobertura de eventos de destaque, estamos sempre presentes para levar a cultura e as notícias de Portugal e da CPLP até si.</p>
                <p>Um dos nossos principais compromissos é com a qualidade de áudio. Por isso, adoptamos uma filosofia de alta fidelidade, disponibilizando todo o nosso conteúdo em formato FLAC. Esta escolha assegura que os nossos ouvintes desfrutem de uma qualidade sonora superior, fazendo com que cada nota musical e cada palavra transmitida cheguem com a clareza e a profundidade que merecem.</p>
                <p>Um destaque especial da nossa programação é o "Música Portuguesa". Este programa é dedicado exclusivamente a músicas de artistas portugueses, promovendo assim a riqueza e a diversidade da nossa cultura musical. Através deste espaço, damos visibilidade aos talentos nacionais, celebrando a criatividade e a originalidade que caracterizam a música de Portugal.</p>
                <p>Além disso, para os amantes da música erudita e/ou Jazz, oferecemos uma selecção das últimas novidades e obras clássicas deste género, garantindo uma programação variada e de alta qualidade para todos os gostos musicais.</p>
                <p>Na Rádio Aberta, acreditamos que a rádio é uma forma poderosa de unir pessoas, transcender fronteiras e celebrar a nossa herança cultural. Convidamo-lo a juntar-se a nós nesta jornada sonora e a descobrir tudo o que temos para oferecer. Sintonize e deixe-se envolver pela Rádio Aberta, onde a qualidade, a cultura e a comunidade são as nossas maiores prioridades.</p>
            </section>
            <section>
                <h2>Programação</h2>
                <ul>
                    <li><strong>Segunda a Sexta:</strong> 9h-10h - Programa da Manhã</li>
                    <li><strong>Segunda a Sexta:</strong> 10h-13h - Música Internacional</li>
                    <li><strong>Segunda a Sexta:</strong> 13h-14h - Notícias e Atualidades</li>
                    <li><strong>Segunda a Sexta:</strong> 14h-16h - Programa da Tarde</li>
                    <li><strong>Sábado:</strong> 10h-12h - Música Portuguesa</li>
                    <li><strong>Domingo:</strong> 10h-12h - Programa de Literatura</li>
                    <li><strong>Fora de Horas:</strong> Estilo Livre</li>
                </ul>
            </section>
            <section id="dados-meteorologicos">
                <h2>Dados Meteorológicos</h2>
                <div id="weather-data"></div> <!-- Container for weather data -->
                <script>
                    document.addEventListener('DOMContentLoaded', () => {
                        const locations = [
                            { name: 'Aveiro', id: '1010500' },
                            { name: 'Beja', id: '1020500' },
                            { name: 'Braga', id: '1030300' },
                            { name: 'Bragança', id: '1040200' },
                            { name: 'Castelo Branco', id: '1050200' },
                            { name: 'Coimbra', id: '1060300' },
                            { name: 'Évora', id: '1070500' },
                            { name: 'Faro', id: '1080500' },
                            { name: 'Funchal', id: '2310300' },
                            { name: 'Guarda', id: '1090700' },
                            { name: 'Leiria', id: '1100900' },
                            { name: 'Lisboa', id: '1110600' },
                            { name: 'Ponta Delgada', id: '2320100' },
                            { name: 'Portalegre', id: '1121400' },
                            { name: 'Porto', id: '1131200' },
                            { name: 'Santarém', id: '1141600' },
                            { name: 'Setúbal', id: '1151200' },
                            { name: 'Viana do Castelo', id: '1160900' },
                            { name: 'Vila Real', id: '1171400' },
                            { name: 'Viseu', id: '1182300' }
                        ];
                    
                        const baseUrl = 'https://api.ipma.pt/open-data/forecast/meteorology/cities/daily/';
                    
                        const fetchWeather = async () => {
                            for (const { name, id } of locations) {
                                try {
                                    const response = await fetch(`${baseUrl}${id}.json`);
                                    if (!response.ok) {
                                        throw new Error(`Failed to fetch weather for ${name}`);
                                    }
                                    const data = await response.json();
                                    displayWeather(data, name);
                                } catch (error) {
                                    console.error('Error fetching weather data:', error);
                                    displayError(name);
                                }
                            }
                        };
                    
                        const getWeatherDescription = (weatherType) => {
                            const weatherDescriptions = {
                                1: 'Céu limpo',
                                2: 'Céu pouco nublado',
                                3: 'Céu parcialmente nublado',
                                4: 'Céu muito nublado ou encoberto',
                                5: 'Céu nublado por nuvens altas',
                                6: 'Aguaceiros',
                                7: 'Chuva fraca ou chuvisco',
                                8: 'Chuva',
                                9: 'Chuva forte',
                                10: 'Períodos de chuva',
                                11: 'Aguaceiros e possibilidade de trovoada',
                                12: 'Chuva e possibilidade de trovoada',
                                13: 'Neblina',
                                14: 'Nevoeiro',
                                15: 'Geada',
                                16: 'Neve',
                                17: 'Granizo',
                                18: 'Trovoada',
                                19: 'Poeira atmosférica',
                                20: 'Fumo',
                                21: 'Nevoeiro ou névoa',
                                22: 'Geada ou gelo',
                                23: 'Brisa',
                                24: 'Ventania',
                                25: 'Vento forte',
                                26: 'Vendaval'
                            };
                            return weatherDescriptions[weatherType] || 'Desconhecido';
                        };
                    
                        function convertCompassPointToPortuguese(englishPoint) {
                            const compassMap = {
                                'N': 'Norte',
                                'NE': 'Nordeste',
                                'E': 'Este',
                                'SE': 'Sudeste',
                                'S': 'Sul',
                                'SW': 'Sudoeste',
                                'W': 'Oeste',
                                'NW': 'Noroeste'
                            };
                        
                            return compassMap[englishPoint] || 'Desconhecido';
                        }

                        const descClassWindSpeedPT = (classWindSpeed) => {
                            const windSpeedDescriptions = {
                                1: 'Fraco',
                                2: 'Moderado',
                                3: 'Forte',
                                4: 'Muito Forte'
                            };
                            return windSpeedDescriptions[classWindSpeed] || 'Desconhecido';
                        };                        
            
                        const displayWeather = (data, location) => {
                            const tempMaxToday = Math.round(data.data[0].tMax);
                            const tempMinToday = Math.round(data.data[0].tMin);
                            const weatherTypeToday = data.data[0].idWeatherType;
                            const precipToday = Math.round(data.data[0].precipitaProb);
                            const windSpeedToday = descClassWindSpeedPT(data.data[0].classWindSpeed);
                            const windDirToday = convertCompassPointToPortuguese(data.data[0].predWindDir);
                    
                            const tempMaxTomorrow = Math.round(data.data[1].tMax);
                            const tempMinTomorrow = Math.round(data.data[1].tMin);
                            const weatherTypeTomorrow = data.data[1].idWeatherType;
                            const precipTomorrow = Math.round(data.data[1].precipitaProb);
                            const windSpeedTomorrow = descClassWindSpeedPT(data.data[1].classWindSpeed);
                            const windDirTomorrow = convertCompassPointToPortuguese(data.data[1].predWindDir);
                    
                            const weatherDescriptionToday = getWeatherDescription(weatherTypeToday);
                            const weatherDescriptionTomorrow = getWeatherDescription(weatherTypeTomorrow);
                    
                            const determineColor = (temp) => {
                                if (temp <= 9) {
                                    return '#00D7FF';
                                } else if (temp <= 19) {
                                    return '#006600';
                                } else if (temp <= 29) {
                                    return '#FFD700';
                                } else if (temp <= 49) {
                                    return '#FF0000';
                                }
                            };
                    
                            const colorMaxToday = determineColor(tempMaxToday);
                            const colorMinToday = determineColor(tempMinToday);
                            const colorMaxTomorrow = determineColor(tempMaxTomorrow);
                            const colorMinTomorrow = determineColor(tempMinTomorrow);
                    
                            let weatherElement = document.getElementById(`weather-${location}`);
                            if (!weatherElement) {
                                weatherElement = document.createElement('div');
                                weatherElement.className = 'weather-item';
                                weatherElement.id = `weather-${location}`;
                                document.getElementById('weather-data').appendChild(weatherElement);
                            }
                    
                            weatherElement.innerHTML = `
                            <table style="width: 100%;">
                                <thead>
                                    <tr>
                                        <th colspan="7">${location}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td></td>
                                        <td>Máx</td>
                                        <td>Min</td>
                                        <td>Precipitação (%)</td>
                                        <td>Vento</td>
                                        <td>Direção</td>
                                        <td>Descrição</td>
                                    </tr>
                                    <tr>
                                        <td>Hoje</td>
                                        <td><span style='color: ${colorMaxToday};'>${tempMaxToday}°C</span></td>
                                        <td><span style='color: ${colorMinToday};'>${tempMinToday}°C</span></td>
                                        <td>${precipToday}%</td>
                                        <td>${windSpeedToday}</td>
                                        <td>${windDirToday}</td>
                                        <td>${weatherDescriptionToday}</td>
                                    </tr>
                                    <tr>
                                        <td>Amanhã</td>
                                        <td><span style='color: ${colorMaxTomorrow};'>${tempMaxTomorrow}°C</span></td>
                                        <td><span style='color: ${colorMinTomorrow};'>${tempMinTomorrow}°C</span></td>
                                        <td>${precipTomorrow}%</td>
                                        <td>${windSpeedTomorrow}</td>
                                        <td>${windDirTomorrow}</td>
                                        <td>${weatherDescriptionTomorrow}</td>
                                    </tr>
                                </tbody>
                            </table>
                            `;
                        };
                    
                        fetchWeather();
                        setInterval(fetchWeather, 60000);
                    });
                </script>
            </section>
            <section id="mapas">
                <h2>Mapa de Portugal e Arquipélagos</h2>
                <div style="display: flex;">
                    <div style="width: 40%; display: flex; flex-direction: column; border-right: 2px solid #000; padding-right: 10px;">
                        <div id="map-azores" style="height: 50%; border-bottom: 2px solid #000; padding-bottom: 10px;"></div>
                        <div id="map-madeira" style="height: 50%; padding-top: 10px;"></div>
                    </div>
                    <div id="map" style="height: 1200px; width: 40%;"></div>
                </div>
            </section>
            
            <!-- Map for Portugal -->
            <script>
                var map = L.map('map').setView([39.3999, -8.2245], 7); // Centered on Portugal with zoom level 7
                
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(map);

                // Restrict map view to Portugal
                var southWest = L.latLng(36.8383, -9.5266);
                var northEast = L.latLng(42.1546, -6.1892);
                var bounds = L.latLngBounds(southWest, northEast);
                map.setMaxBounds(bounds);
                map.on('drag', function() {
                    map.panInsideBounds(bounds, { animate: false });
                });

                // Disable too much zoom out on map
                map.setMinZoom(7);

                // Add scale control to map
                L.control.scale({ position: 'bottomleft' }).addTo(map);          
                
                // Disable scrolling on map
                map.scrollWheelZoom.disable();

                // Add markers for major cities in Portugal
                var cities = [
                    Aveiro = { name: 'Aveiro', coords: [40.6401, -8.6538] },
                    Beja = { name: 'Beja', coords: [38.0151, -7.8639] },
                    Braga = { name: 'Braga', coords: [41.5333, -8.4167] },
                    Bragança = { name: 'Bragança', coords: [41.8055, -6.7575] },
                    Castelo_Branco = { name: 'Castelo Branco', coords: [39.8222, -7.4903] },
                    Coimbra = { name: 'Coimbra', coords: [40.2033, -8.4103] },
                    Évora = { name: 'Évora', coords: [38.5667, -7.9000] },
                    Faro = { name: 'Faro', coords: [37.0194, -7.9322] },
                    Funchal = { name: 'Funchal', coords: [32.6669, -16.9241] },
                    Guarda = { name: 'Guarda', coords: [40.5373, -7.2674] },
                    Leiria = { name: 'Leiria', coords: [39.7436, -8.8071] },
                    Portalegre = { name: 'Portalegre', coords: [39.2974, -7.4304] },
                    Porto = { name: 'Porto', coords: [41.1579, -8.6291] },
                    Ponta_Delgada = { name: 'Ponta Delgada', coords: [37.7412, -25.6756] },
                    Santarém = { name: 'Santarém', coords: [39.2362, -8.6850] },
                    Viana_do_Castelo = { name: 'Viana do Castelo', coords: [41.6935, -8.8326] },
                    Vila_Real = { name: 'Vila Real', coords: [41.3000, -7.7500] },
                    Viseu = { name: 'Viseu', coords: [40.6667, -7.9000] },
                    Lisboa = { name: 'Lisboa', coords: [38.7223, -9.1393] }
                ];

                cities.forEach(city => {
                    L.marker(city.coords).addTo(map)
                        .bindPopup(city.name)
                        .openPopup();
                });

                // Add complete map controls
                L.control.zoom({ position: 'bottomright' }).addTo(map);
                L.control.fullscreen({ position: 'topright' }).addTo(map);
            </script>
            <!-- Map for Açores -->
            <script>
                // Create a map for Açores
                var mapAzores = L.map('map-azores').setView([37.7412, -25.6756], 6); // Centered on Ponta Delgada with zoom level 9

                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(mapAzores);

                // Restrict map view to Açores
                var southWestAzores = L.latLng(36.8383, -31.5266);
                var northEastAzores = L.latLng(40.1546, -24.1892);
                var boundsAzores = L.latLngBounds(southWestAzores, northEastAzores);
                mapAzores.setMaxBounds(boundsAzores);
                mapAzores.on('drag', function() {
                    mapAzores.panInsideBounds(boundsAzores, { animate: false });
                });

                // Disable too much zoom out on map
                mapAzores.setMinZoom(6);

                // Add scale control to map
                L.control.scale({ position: 'bottomleft' }).addTo(mapAzores);

                // Add complete map controls
                L.control.zoom({ position: 'bottomright' }).addTo(mapAzores);

                // Disable Scroll Wheel Zoom
                mapAzores.scrollWheelZoom.disable();

                // Add markers for Ponta Delgada and Angra do Heroísmo
                var citiesAzores = [
                    Angra_do_Heroismo = {name: 'Angra do Heroísmo', coords: [38.6500, -27.2167]},
                    Ponta_Delgada = { name: 'Ponta Delgada', coords: [37.7412, -25.6756] },
                ];

                citiesAzores.forEach(city => {
                    L.marker(city.coords).addTo(mapAzores)
                        .bindPopup(city.name)
                        .openPopup();
                });
            </script>
            <!-- Map for Madeira -->
            <script>
                // Create a map for Madeira
                var mapMadeira = L.map('map-madeira').setView([32.6669, -16.9241], 7); // Centered on Funchal with zoom level 9

                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(mapMadeira);

                // Restrict map view to Madeira
                var southWestMadeira = L.latLng(32.0000, -17.5000);
                var northEastMadeira = L.latLng(33.5000, -16.0000);
                var boundsMadeira = L.latLngBounds(southWestMadeira, northEastMadeira);
                mapMadeira.setMaxBounds(boundsMadeira);
                mapMadeira.on('drag', function() {
                    mapMadeira.panInsideBounds(boundsMadeira, { animate: false });
                });

                // Disable too much zoom out on map
                mapMadeira.setMinZoom(7);

                // Add scale control to map
                L.control.scale({ position: 'bottomleft' }).addTo(mapMadeira);

                // Add complete map controls
                L.control.zoom({ position: 'bottomright' }).addTo(mapMadeira);

                // Disable Scroll Wheel Zoom
                mapMadeira.scrollWheelZoom.disable();

                // Add markers for Funchal and Porto Santo
                var citiesMadeira = [
                    Porto_Santo = { name: 'Porto Santo', coords: [33.0722, -16.3414] },
                    Funchal = { name: 'Funchal', coords: [32.6669, -16.9241] }
                ];

                citiesMadeira.forEach(city => {
                    L.marker(city.coords).addTo(mapMadeira)
                        .bindPopup(city.name)
                        .openPopup();
                });
            </script>
            <section id="rss-news" style="width: 75%;"></section>
            </section>
            <script>
                const feeds = [
                    {name: "<u><span style='color: #FFD700;'>Jornal Fumaça</span></u>", url: "https://fumaca.pt/feed/"},
                    {name: "<u><span style='color: #FFD700;'>Jornal Mapa</span></u>", url: "https://jornalmapa.pt/feed/"},
                    {name: "<u><span style='color: #FFD700;'>Jornal Público</span></u>", url: "https://feeds.feedburner.com/PublicoRSS"},
                    {name: "<u><span style='color: #FFD700;'>Jornal de Negócios</span></u>", url: "https://www.jornaldenegocios.pt/rss"},
                    {name: "<u><span style='color: #FFD700;'>Noticias ao Minuto</span></u>", url: "https://www.noticiasaominuto.com/rss/cultura"},
                    {name: "<u><span style='color: #FFD700;'>Observador</span></u>", url: "https://observador.pt/rss"},
                    {name: "<u><span style='color: #FFD700;'>Outras Palavras</span></u>", url: "https://outraspalavras.net/feed/"},
                    {name: "<u><span style='color: #FFD700;'>Jornal Record</span></u>", url: "https://www.record.pt/rss"},
                    {name: "<u><span style='color: #FFD700;'>RTP</span></u>", url: "https://www.rtp.pt/noticias/rss"}
                ];
            
                const rssContainer = document.getElementById('rss-news');
            
                function fetchAndDisplayFeeds() {
                    // Clear previous content
                    rssContainer.innerHTML = '<h2>Notícias</h2>';
                
                    // Use Promise.all to wait for all fetch requests to complete
                    Promise.all(feeds.map(feed => 
                        fetch(`https://api.rss2json.com/v1/api.json?rss_url=${feed.url}`)
                            .then(response => response.json())
                            .catch(error => console.error('Error fetching the RSS feed:', error))
                    )).then(results => {
                        results.forEach((data, index) => {
                            if (!data) return; // Skip if fetch failed
                            let section = document.createElement('div');
                            section.innerHTML = `<h2>${feeds[index].name}</h2>`;
                            data.items.slice(0, 12).forEach((item) => {
                                let articleBox = document.createElement('div');
                                articleBox.style.border = '1px solid #ccc';
                                articleBox.style.padding = '10px';
                                articleBox.style.marginBottom = '10px';
                                let contentWithoutImages = item.content.replace(/<img[^>]*>/g, "");
                                let firstParagraph = contentWithoutImages.split('</p>')[0] + '</p>';
                                articleBox.innerHTML = `<a href="${item.link}" target="_blank">${item.title}</a><br>${firstParagraph}`;
                                section.appendChild(articleBox);
                            });
                            rssContainer.appendChild(section);
                        });
                    });
                }
            
                // Chama fetchAndDisplayFeeds imediatamente para carregar os feeds na inicialização
                fetchAndDisplayFeeds();
            
                // Atualiza os feeds a cada 10 minutos (600000 milissegundos)
                setInterval(fetchAndDisplayFeeds, 600000);
            </script>
            <section>
                <h2>Jogos</h2>
                <div id="board" style="width: 640px"></div>
            </section>
            <script>
                document.addEventListener('DOMContentLoaded', () => {
                    var board = Chessboard('board', {
                        position: 'start',
                        showNotation: true,
                        pieceTheme: 'https://chessboardjs.com/img/chesspieces/wikipedia/{piece}.png',
                        draggable: true,
                        onDrop: handleMove
                    });
        
                    var game = new Chess();
        
                    function handleMove(source, target) {
                        // Attempt to make a move
                        var move = game.move({
                            from: source,
                            to: target,
                            promotion: 'q' // NOTE: Always promote to a queen for simplicity
                        });
        
                        // Illegal move
                        if (move === null) return 'snapback';
        
                        // Make a random move for the computer
                        window.setTimeout(makeRandomComputerMove, 250);
                    }

                    // Disable moving black pieces
                    function onDragStart(source, piece, position, orientation) {
                        if (game.turn() === 'b' || piece.search(/^b/) !== -1) {
                            return false;
                        }
                    }
        
                    function makeRandomComputerMove() {
                        var possibleMoves = game.moves();
        
                        // Game over
                        if (possibleMoves.length === 0) return;
        
                        var randomIdx = Math.floor(Math.random() * possibleMoves.length);
                        game.move(possibleMoves[randomIdx]);
                        board.position(game.fen());
                    }
        
                    // Update the board position after the piece snap
                    // for castling, en passant, pawn promotion
                    board.on('snapEnd', () => {
                        board.position(game.fen());
                    });
                });
            </script>
            <section>
                <h2>Equipa</h2>
                <ul>
                    <li><strong>Fundador:</strong> André Machado</li>
                    <li><strong>Locutores:</strong> </li>
                    <li><strong>Jornalistas:</strong> </li>
                </ul>
            </section>
            <section>
                <h2>Contactos</h2>
                <ul>
                    <li><strong>Morada:</strong> Rua da Rádio, Lisboa</li>
                    <li><strong>Telefone:</strong> </li>
                    <li><strong>Email:</strong> info@radioaberta.eu.org</li>
                </ul>
            </section>
        </main>
        <script>
            // Function to shuffle an array randomly
            function shuffleArray(array) {
                // Initial Fisher-Yates shuffle using crypto.getRandomValues
                for (let i = array.length - 1; i > 0; i--) {
                    const randomValues = new Uint32Array(1);
                    window.crypto.getRandomValues(randomValues);
                    const j = randomValues[0] % (i + 1);
                    [array[i], array[j]] = [array[j], array[i]];
                }
            
                // Additional unnecessary complexity: Reverse and then shuffle again with Math.random
                array.reverse();
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            
                return array;
            }

            // Function to play Noticias e Atualidades
            function playNoticiasEAtualidades() {
                // Get the current date and format it as "news_audio_%d_%m_%Y.mp3"
                const currentDate = new Date();
                const formattedDate = currentDate.toLocaleDateString('pt-PT', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric'
                }).replace(/\//g, '_');
                const newsfile = `news_audio_${formattedDate}.mp3`;
            
                // Fetch the news file
                fetch('news/').then(response => response.text())
                    .then(data => {
                        const sound = new Howl({
                            src: [`news/${newsfile}`],
                            volume: 1,
                            onloaderror: (id, error) => console.error('Error loading news file:', error),
                            onplayerror: (id, error) => console.error('Error playing news file:', error),
                        });
            
                        // Retrieve saved playback position from local storage
                        const savedPosition = localStorage.getItem('playbackPosition');
                        if (savedPosition) {
                            sound.seek(parseFloat(savedPosition));
                        }
            
                        // Play button
                        const playButton = document.getElementById('playButton');
                        playButton.addEventListener('click', () => {
                            // Play the current music if it is not playing
                            if (!sound.playing()) {
                                sound.play();
                                playButton.style.backgroundColor = 'green'; // Set background color to green
                                pauseButton.style.backgroundColor = ''; // Remove background color
                            }
                        });

                        // Pause button
                        const pauseButton = document.getElementById('pauseButton');
                        pauseButton.addEventListener('click', () => {
                            // Pause the current music if it is playing
                            if (sound.playing()) {
                                sound.pause();
                                // Save the current playback position to local storage
                                localStorage.setItem('playbackPosition', sound.seek());
                                playButton.style.backgroundColor = ''; // Remove background color
                                pauseButton.style.backgroundColor = 'red'; // Set background color to red
                            }
                        });
                    })
                    .catch(error => {
                        console.error('Error fetching news files:', error);
                    });
            }

            // Function to play Música Internacional
            function playMusicaInternacional() {
                // Fetch all the music files in the "international_music/" folder
                fetch('international_music/').then(response => response.text())
                    .then(data => {
                        // Parse the HTML response to extract the music file names
                        const parser = new DOMParser();
                        const htmlDoc = parser.parseFromString(data, 'text/html');
                        const musicFiles = Array.from(htmlDoc.querySelectorAll('a[href$=".flac"]'))
                            .map(a => a.href);

                        // Shuffle the music files array randomly
                        const shuffledMusicFiles = shuffleArray(musicFiles);

                        let currentSoundIndex = 0;
                        let sounds = [];

                        // Function to load and play a music
                        function loadAndPlaySound(index) {
                            if (sounds[index]) {
                                sounds[index].unload(); // Unload the current music
                            }

                            sounds[index] = new Howl({
                                src: [musicFiles[index]],
                                volume: 1,
                                onloaderror: (id, error) => console.error('Error loading music file:', error),
                                onplayerror: (id, error) => console.error('Error playing music file:', error),
                                onend: () => {
                                    // When the current music ends, load and play the next music
                                    currentSoundIndex = (currentSoundIndex + 1) % musicFiles.length;
                                    loadAndPlaySound(currentSoundIndex);
                                    sounds[currentSoundIndex].play(); // Play the next music
                                }
                            });
                        }

                        // Play button
                        const playButton = document.getElementById('playButton');
                        playButton.addEventListener('click', () => {
                            // Play the current music if it is not playing
                            if (!sounds[currentSoundIndex]) {
                                loadAndPlaySound(currentSoundIndex);
                            }
                            
                            if (!sounds[currentSoundIndex].playing()) {
                                sounds[currentSoundIndex].play(); // Play the current music if it is paused
                                playButton.style.backgroundColor = 'green'; // Set background color to green
                                pauseButton.style.backgroundColor = ''; // Remove background color
                            }
                        });

                        // Pause button
                        const pauseButton = document.getElementById('pauseButton');
                        pauseButton.addEventListener('click', () => {
                            // Pause the current music if it is playing
                            if (sounds[currentSoundIndex].playing()) {
                                sounds[currentSoundIndex].pause();
                                playButton.style.backgroundColor = ''; // Remove background color
                                pauseButton.style.backgroundColor = 'red'; // Set background color to red
                            }
                        });

                        // Create a single paragraph element to display the current song
                        const currentSong = document.createElement('p');
                        currentSong.style.fontWeight = 'bold';
                        currentSong.style.marginTop = '20px';
                        currentSong.style.textAlign = 'center'; // Center the message
                        document.querySelector('header').appendChild(currentSong);

                        // Function to update the current song being played
                        const updateCurrentSong = () => {
                            // Check if there is a current sound playing
                            if (sounds[currentSoundIndex]) {
                                // Get the current song name and remove the track number and file extension
                                const currentSongName = decodeURIComponent(musicFiles[currentSoundIndex].split('/').pop());
                                currentSong.textContent = currentSongName.replace(/^\d{2}[\.-]/, '').replace(/\.flac$/, '');
                                    
                                // Display the current song duration
                                const duration = Math.round(sounds[currentSoundIndex].duration());
                                const currentTime = Math.round(sounds[currentSoundIndex].seek());
                                currentSong.textContent += ` (${Math.floor(currentTime / 60)}:${('0' + (currentTime % 60)).slice(-2)}/${Math.floor(duration / 60)}:${('0' + (duration % 60)).slice(-2)})`;

                                // Highlight the current song being played
                                currentSong.style.color = 'grey'; // Set the text color to grey
                            } else {
                                currentSong.textContent = '';
                            }
                        };
                        // Update the current song every second
                        setInterval(updateCurrentSong, 1000);

                    })
                    .catch(error => {
                        console.error('Error fetching music files:', error);
                    });
            }

            // Function to play Música Portuguesa
            function playMusicaPortuguesa() {
                // Fetch all the music files in the "portuguese_music/" folder
                fetch('portuguese_music/').then(response => response.text())
                    .then(data => {
                        // Parse the HTML response to extract the music file names
                        const parser = new DOMParser();
                        const htmlDoc = parser.parseFromString(data, 'text/html');
                        const musicFiles = Array.from(htmlDoc.querySelectorAll('a[href$=".flac"]'))
                            .map(a => a.href);

                        // Shuffle the music files array randomly
                        const shuffledMusicFiles = shuffleArray(musicFiles);

                        let currentSoundIndex = 0;
                        let sounds = [];

                        // Function to load and play a music
                        function loadAndPlaySound(index) {
                            if (sounds[index]) {
                                sounds[index].unload(); // Unload the current music
                            }

                            sounds[index] = new Howl({
                                src: [musicFiles[index]],
                                volume: 1,
                                onloaderror: (id, error) => console.error('Error loading music file:', error),
                                onplayerror: (id, error) => console.error('Error playing music file:', error),
                                onend: () => {
                                    // When the current music ends, load and play the next music
                                    currentSoundIndex = (currentSoundIndex + 1) % musicFiles.length;
                                    loadAndPlaySound(currentSoundIndex);
                                    sounds[currentSoundIndex].play(); // Play the next music
                                }
                            });
                        }

                        // Play button
                        const playButton = document.getElementById('playButton');
                        playButton.addEventListener('click', () => {
                            // Play the current music if it is not playing
                            if (!sounds[currentSoundIndex]) {
                                loadAndPlaySound(currentSoundIndex);
                            }
                            
                            if (sounds[currentSoundIndex].playing()) {
                                playButton.style.backgroundColor = 'green'; // Remove background color
                                pauseButton.style.backgroundColor = ''; // Remove background color
                            } else {
                                sounds[currentSoundIndex].play(); // Play the current music if it is paused
                                playButton.style.backgroundColor = 'green'; // Set background color to green
                                pauseButton.style.backgroundColor = ''; // Remove background color
                            }
                        });

                        // Pause button
                        const pauseButton = document.getElementById('pauseButton');
                        pauseButton.addEventListener('click', () => {
                            // Pause the current music if it is playing
                            if (sounds[currentSoundIndex].playing()) {
                                sounds[currentSoundIndex].pause();
                            }

                            playButton.style.backgroundColor = ''; // Remove background color
                            pauseButton.style.backgroundColor = 'red'; // Set background color to red
                        });

                        // Create a single paragraph element to display the current song
                        const currentSong = document.createElement('p');
                        currentSong.style.fontWeight = 'bold';
                        currentSong.style.marginTop = '20px';
                        currentSong.style.textAlign = 'center'; // Center the message
                        document.querySelector('header').appendChild(currentSong);

                        // Function to update the current song being played
                        const updateCurrentSong = () => {
                            // Check if there is a current sound playing
                            if (sounds[currentSoundIndex]) {
                                // Get the current song name and remove the track number and file extension
                                const currentSongName = decodeURIComponent(musicFiles[currentSoundIndex].split('/').pop());
                                currentSong.textContent = currentSongName.replace(/^\d{2}[\.-]/, '').replace(/\.flac$/, '');
                                    
                                // Display the current song duration
                                const duration = Math.round(sounds[currentSoundIndex].duration());
                                const currentTime = Math.round(sounds[currentSoundIndex].seek());
                                currentSong.textContent += ` (${Math.floor(currentTime / 60)}:${('0' + (currentTime % 60)).slice(-2)}/${Math.floor(duration / 60)}:${('0' + (duration % 60)).slice(-2)})`;

                                // Highlight the current song being played
                                currentSong.style.color = 'grey'; // Set the text color to grey
                            } else {
                                currentSong.textContent = '';
                            }
                        };
                        // Update the current song every second
                        setInterval(updateCurrentSong, 1000);

                    })
                    .catch(error => {
                        console.error('Error fetching music files:', error);
                    });
            }

            // Function to play all the music from the portuguese_music/ folder randomly
            function playEstiloLivre() {
                // Fetch all the music files in the "portuguese_music/" and "international_music/" folders
                Promise.all([
                fetch('portuguese_music/').then(response => response.text()),
                fetch('international_music/').then(response => response.text())
                ])
                    .then(([portugueseData, internationalData]) => {
                        // Parse the HTML responses to extract the music file names
                        const parser = new DOMParser();
                        const portugueseHtmlDoc = parser.parseFromString(portugueseData, 'text/html');
                        const internationalHtmlDoc = parser.parseFromString(internationalData, 'text/html');

                        const portugueseMusicFiles = Array.from(portugueseHtmlDoc.querySelectorAll('a[href$=".flac"]'))
                            .map(a => a.href);
                        const internationalMusicFiles = Array.from(internationalHtmlDoc.querySelectorAll('a[href$=".flac"]'))
                            .map(a => a.href);

                        // Combine the music files arrays
                        const musicFiles = [...portugueseMusicFiles, ...internationalMusicFiles];

                        // Shuffle the music files array randomly
                        const shuffledMusicFiles = shuffleArray(musicFiles);

                        let currentSoundIndex = 0;
                        let sounds = [];

                        // Function to load and play a music
                        function loadAndPlaySound(index) {
                            if (sounds[index]) {
                                sounds[index].unload(); // Unload the current music
                            }

                            sounds[index] = new Howl({
                                src: [musicFiles[index]],
                                volume: 1,
                                onloaderror: (id, error) => console.error('Error loading music file:', error),
                                onplayerror: (id, error) => console.error('Error playing music file:', error),
                                onend: () => {
                                    // When the current music ends, load and play the next music
                                    currentSoundIndex = (currentSoundIndex + 1) % musicFiles.length;
                                    loadAndPlaySound(currentSoundIndex);
                                    sounds[currentSoundIndex].play(); // Play the next music
                                }
                            });
                        }

                        // Play button
                        const playButton = document.getElementById('playButton');
                        playButton.addEventListener('click', () => {
                            // Play the current music if it is not playing
                            if (!sounds[currentSoundIndex]) {
                                loadAndPlaySound(currentSoundIndex);
                            }
                            
                            if (sounds[currentSoundIndex].playing()) {
                                playButton.style.backgroundColor = 'green'; // Remove background color
                                pauseButton.style.backgroundColor = ''; // Remove background color
                            } else {
                                sounds[currentSoundIndex].play(); // Play the current music if it is paused
                                playButton.style.backgroundColor = 'green'; // Set background color to green
                                pauseButton.style.backgroundColor = ''; // Remove background color
                            }
                        });

                        // Pause button
                        const pauseButton = document.getElementById('pauseButton');
                        pauseButton.addEventListener('click', () => {
                            // Pause the current music if it is playing
                            if (sounds[currentSoundIndex].playing()) {
                                sounds[currentSoundIndex].pause();
                            }

                            playButton.style.backgroundColor = ''; // Remove background color
                            pauseButton.style.backgroundColor = 'red'; // Set background color to red
                        });

                        // Create a single paragraph element to display the current song
                        const currentSong = document.createElement('p');
                        currentSong.style.fontWeight = 'bold';
                        currentSong.style.marginTop = '20px';
                        currentSong.style.textAlign = 'center'; // Center the message
                        document.querySelector('header').appendChild(currentSong);

                        // Function to update the current song being played
                        const updateCurrentSong = () => {
                            // Check if there is a current sound playing
                            if (sounds[currentSoundIndex]) {
                                // Get the current song name and remove the track number and file extension
                                const currentSongName = decodeURIComponent(musicFiles[currentSoundIndex].split('/').pop());
                                currentSong.textContent = currentSongName.replace(/^\d{2}[\.-]/, '').replace(/\.flac$/, '');
                                    
                                // Display the current song duration
                                const duration = Math.round(sounds[currentSoundIndex].duration());
                                const currentTime = Math.round(sounds[currentSoundIndex].seek());
                                currentSong.textContent += ` (${Math.floor(currentTime / 60)}:${('0' + (currentTime % 60)).slice(-2)}/${Math.floor(duration / 60)}:${('0' + (duration % 60)).slice(-2)})`;

                                // Highlight the current song being played
                                currentSong.style.color = 'grey'; // Set the text color to grey
                            } else {
                                currentSong.textContent = '';
                            }
                        };
                        // Update the current song every second
                        setInterval(updateCurrentSong, 1000);
                    })
                .catch(error => {
                    console.error('Error fetching music files:', error);
                });
            }
        </script>
        <footer>
            <center>
                <p>&copy; 2024 Rádio Aberta</p>
            </center>
        </footer>
    </body>
</html>
